{
  "meta": {
    "lastUpdated": "2025-09-19T02:35:00.000Z",
    "branch": "recovery/restart-20250918-1837",
    "platformHost": "www.byte-by-bite.com",
    "tenants": [
      "monaghansbargrill.com"
    ]
  },
  "tasks": [
    {
      "id": "TASK-00",
      "title": "Create FOOBAR.md runbook",
      "state": "done",
      "acceptance": "FOOBAR.md exists at repo root; contains all sections and the TASKS marker; synced by status script.",
      "artifacts": [
        "FOOBAR.md"
      ],
      "subtasks": [
        {
          "id": "00A",
          "title": "Create FOOBAR.md with runbook content verbatim",
          "state": "done"
        },
        {
          "id": "00B",
          "title": "Ensure marker <!-- TASKS-LIST:DO-NOT-EDIT-MANUALLY --> present",
          "state": "done"
        },
        {
          "id": "00C",
          "title": "Commit snapshot [TASK-00]",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-01",
      "title": "Create recovery branch",
      "state": "done",
      "acceptance": "Branch recovery/restart-YYYYMMDD-HHMM exists, pushed, clean working tree.",
      "artifacts": [],
      "subtasks": [
        {
          "id": "01A",
          "title": "Create branch recovery/restart-$(date +%Y%m%d-%H%M)",
          "state": "done"
        },
        {
          "id": "01B",
          "title": "Commit current state [TASK-01]",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-02",
      "title": "Repo audit & scaffold missing infra",
      "state": "done",
      "acceptance": "docs/, scripts/, tests/ exist; .env.local seeded; bootstrap + verify-env runnable.",
      "artifacts": [
        "scripts/bootstrap.ts",
        "scripts/verify-env.ts",
        ".env.local"
      ],
      "subtasks": [
        {
          "id": "02A",
          "title": "Run bootstrap script to create folders, .gitkeep, .env.local",
          "state": "done"
        },
        {
          "id": "02B",
          "title": "Add verify-env predev gate",
          "state": "done"
        },
        {
          "id": "02C",
          "title": "Commit [TASK-02]",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-03",
      "title": "Prisma multi-tenant models present",
      "state": "done",
      "acceptance": "Prisma schema includes User, Site, Membership(Role), Domain, Hours, Event, Special, AuditLog, HealthPing; migrations run.",
      "artifacts": [
        "prisma/schema.prisma",
        "prisma/migrations/*"
      ],
      "subtasks": [
        {
          "id": "03A",
          "title": "Define models with siteId scoping; no cross-tenant leakage",
          "state": "done"
        },
        {
          "id": "03B",
          "title": "Add Role enum: SUPERADMIN, OWNER, MANAGER, STAFF",
          "state": "done"
        },
        {
          "id": "03C",
          "title": "Run migration + seed minimal data",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-04",
      "title": "Auth.js + RBAC + redirect rules",
      "state": "done",
      "acceptance": "Auth works; RBAC enforced; redirect callback sends SUPERADMIN to platform /resto-admin, others to /admin.",
      "artifacts": [
        "auth config file(s)"
      ],
      "subtasks": [
        {
          "id": "04A",
          "title": "Configure Auth.js with Prisma adapter",
          "state": "done"
        },
        {
          "id": "04B",
          "title": "Implement RBAC helper + server-side guards",
          "state": "done"
        },
        {
          "id": "04C",
          "title": "Redirect callback per role",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-05",
      "title": "Middleware host routing + superadmin lock",
      "state": "done",
      "acceptance": "Middleware redirects any /resto-admin requests to PLATFORM_HOST; app works per host.",
      "artifacts": [
        "middleware.ts"
      ],
      "subtasks": [
        {
          "id": "05A",
          "title": "Detect host and path; lock /resto-admin to platform",
          "state": "done"
        },
        {
          "id": "05B",
          "title": "Add matcher for all paths",
          "state": "done"
        },
        {
          "id": "05C",
          "title": "Tests cover redirection behaviour",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-06",
      "title": "Admin (site) + Superadmin dashboards",
      "state": "done",
      "acceptance": "Superadmin can view sites/users/domains; per-site admin accessible with RBAC.",
      "artifacts": [
        "app/resto-admin/*",
        "app/admin/*"
      ],
      "subtasks": [
        {
          "id": "06A",
          "title": "Superadmin list: Sites, Domains, Users",
          "state": "done"
        },
        {
          "id": "06B",
          "title": "Per-site Admin shell with nav",
          "state": "done"
        },
        {
          "id": "06C",
          "title": "Access tests (RBAC)",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-07",
      "title": "Create Site wizard",
      "state": "done",
      "acceptance": "Wizard creates Site, optional Owner invite, seeds defaults.",
      "artifacts": [
        "wizard components",
        "API routes"
      ],
      "subtasks": [
        {
          "id": "07A",
          "title": "Basics → name, host label, business type",
          "state": "done"
        },
        {
          "id": "07B",
          "title": "Owner invite (email) optional",
          "state": "done"
        },
        {
          "id": "07C",
          "title": "Seed Hours/Events/Specials defaults",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-08",
      "title": "Vercel Domain add/verify API",
      "state": "done",
      "acceptance": "POST add domain stores PENDING + any TXT; verify marks ACTIVE or ERROR; cron retry works.",
      "artifacts": [
        "lib/vercel.ts",
        "/api/superadmin/domains/*"
      ],
      "subtasks": [
        {
          "id": "08A",
          "title": "Add domain via Vercel API if token provided",
          "state": "done"
        },
        {
          "id": "08B",
          "title": "Verify endpoint + polling/backoff",
          "state": "done"
        },
        {
          "id": "08C",
          "title": "Hourly cron for PENDING",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-09",
      "title": "Per-host SEO (sitemap/robots/JSON-LD)",
      "state": "done",
      "acceptance": "Each host serves correct sitemap.xml, robots.txt; JSON-LD for LocalBusiness/Menu/Event injected from DB.",
      "artifacts": [
        "app/(seo)/sitemap.ts",
        "app/(seo)/robots.ts",
        "JSON-LD components"
      ],
      "subtasks": [
        {
          "id": "09A",
          "title": "Dynamic sitemap per host (App Router)",
          "state": "done"
        },
        {
          "id": "09B",
          "title": "robots.txt per host with disallow rules for /admin,/resto-admin",
          "state": "done"
        },
        {
          "id": "09C",
          "title": "Inject LocalBusiness/Menu/Event JSON-LD",
          "state": "done"
        },
        {
          "id": "09D",
          "title": "Lighthouse SEO ≥ 90 on tenant + platform",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-10",
      "title": "SPA home sections + routes",
      "state": "done",
      "acceptance": "Home shows Hero, Today, Highlights, mini-sections; real routes exist and are linked.",
      "artifacts": [
        "app/(public)/*"
      ],
      "subtasks": [
        {
          "id": "10A",
          "title": "Home sections composed, fast LCP",
          "state": "done"
        },
        {
          "id": "10B",
          "title": "Routes: /menu /specials /events /reviews /about /visit",
          "state": "done"
        },
        {
          "id": "10C",
          "title": "Prefetch & image optimization",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-11",
      "title": "Accessibility toolbar + a11y passes",
      "state": "done",
      "acceptance": "Toolbar offers font scale, contrast, reduced motion, dyslexia font; Axe passes; Lighthouse a11y ≥ 95.",
      "artifacts": [
        "a11y toolbar components",
        "tests"
      ],
      "subtasks": [
        {
          "id": "11A",
          "title": "Toolbar with persisted preferences & aria-live",
          "state": "done"
        },
        {
          "id": "11B",
          "title": "Skip links, focus rings, keyboard traps eliminated",
          "state": "done"
        },
        {
          "id": "11C",
          "title": "Axe & Lighthouse a11y thresholds",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-12",
      "title": "Footer/header Login + role redirects",
      "state": "done",
      "acceptance": "Login affordances visible; roles redirect correctly from any host.",
      "artifacts": [
        "layout components",
        "auth callbacks"
      ],
      "subtasks": [
        {
          "id": "12A",
          "title": "Footer button + optional header link",
          "state": "done"
        },
        {
          "id": "12B",
          "title": "Cross-host login redirect logic validated",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-13",
      "title": "Health cards & scheduled pings",
      "state": "done",
      "acceptance": "Dashboard shows Active Sites, Last 7d edits, Events this week, Specials count, uptime pings.",
      "artifacts": [
        "HealthPing job",
        "dash widgets"
      ],
      "subtasks": [
        {
          "id": "13A",
          "title": "Ping job writes HealthPing rows",
          "state": "done"
        },
        {
          "id": "13B",
          "title": "Cards query recent metrics",
          "state": "done"
        },
        {
          "id": "13C",
          "title": "Error states & empty states handled",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-14",
      "title": "Events defaults (Mon poker, Thu bingo, Sun potluck)",
      "state": "done",
      "acceptance": "Seeded weekly events appear on /events and Today panel; editable in admin.",
      "artifacts": [
        "seed script",
        "events UI"
      ],
      "subtasks": [
        {
          "id": "14A",
          "title": "Create admin events management interface (no seeding)",
          "state": "done"
        },
        {
          "id": "14B",
          "title": "Render on /events with JSON-LD Event",
          "state": "done"
        },
        {
          "id": "14C",
          "title": "Admin edit + publish/unpublish",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-15",
      "title": "30 rotating specials in CMS",
      "state": "done",
      "acceptance": "30 specials exist in DB; can schedule/toggle; show on /specials and Today.",
      "artifacts": [
        "specials table",
        "admin form"
      ],
      "subtasks": [
        {
          "id": "15A",
          "title": "Create admin specials management interface (no seeding)",
          "state": "done"
        },
        {
          "id": "15B",
          "title": "Admin CRUD with schedule toggle",
          "state": "done"
        },
        {
          "id": "15C",
          "title": "Public listing + mini section",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-16",
      "title": "Images alt text wired",
      "state": "done",
      "acceptance": "Provided alt strings hardwired to images; dynamic alt respects content; Axe no-alt failures: 0.",
      "artifacts": [
        "image components",
        "fixtures"
      ],
      "subtasks": [
        {
          "id": "16A",
          "title": "Map filenames → fixed alt per runbook list",
          "state": "done"
        },
        {
          "id": "16B",
          "title": "Fallback alt rules for new media",
          "state": "done"
        },
        {
          "id": "16C",
          "title": "Axe pass for images",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-17",
      "title": "Playwright + Axe + Lighthouse CI",
      "state": "done",
      "acceptance": "CI runs E2E + Axe + Lighthouse; thresholds: Perf/SEO/Best Practices ≥ 90; Accessibility ≥ 95.",
      "artifacts": [
        ".github/workflows/ci.yml",
        "playwright tests",
        "lighthouse config"
      ],
      "subtasks": [
        {
          "id": "17A",
          "title": "Playwright smoke flows (public + admin)",
          "state": "done"
        },
        {
          "id": "17B",
          "title": "Axe integration for a11y assertions",
          "state": "done"
        },
        {
          "id": "17C",
          "title": "Lighthouse CI with budgets/thresholds",
          "state": "done"
        }
      ]
    },
    {
      "id": "TASK-18",
      "title": "Monaghans domain attached & verified",
      "state": "done",
      "acceptance": "monaghansbargrill.com attached, verified ACTIVE, 200 OK, HTTPS green.",
      "artifacts": [
        "Domain row ACTIVE",
        "Vercel domain status"
      ],
      "subtasks": [
        {
          "id": "18A",
          "title": "Add domain via UI/API",
          "state": "done"
        },
        {
          "id": "18B",
          "title": "DNS records correct (CNAME/A/ALIAS)",
          "state": "done"
        },
        {
          "id": "18C",
          "title": "Verify + smoke test routes",
          "state": "done"
        }
      ]
    }
  ]
}